<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成绩系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .app-container {
            width: 100%;
            max-width: 500px;
            height: 90vh;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            position: relative;
        }
        
        /* 页面通用样式 */
        .page {
            width: 100%;
            height: 100%;
            padding: 30px;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            opacity: 0;
            pointer-events: none;
            transition: all 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            transform: translateY(20px);
            overflow-y: auto;
        }
        
        .page.active {
            opacity: 1;
            pointer-events: all;
            transform: translateY(0);
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .page-header h1 {
            color: #1a2a6c;
            font-size: 28px;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .page-header p {
            color: #666;
            font-size: 16px;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #1a2a6c, #4a7bff);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
            box-shadow: 0 5px 15px rgba(26, 42, 108, 0.3);
        }
        
        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
            font-size: 16px;
        }
        
        .form-control {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: #f9f9f9;
        }
        
        .form-control:focus {
            border-color: #4a7bff;
            background-color: white;
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 123, 255, 0.2);
        }
        
        .form-control.error {
            border-color: #ff4b2b;
        }
        
        .error-text {
            color: #ff4b2b;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
        .btn {
            background: linear-gradient(to right, #1a2a6c, #4a7bff);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(26, 42, 108, 0.3);
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(26, 42, 108, 0.4);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        /* VIP首页样式 */
        .vip-status {
            background: linear-gradient(135deg, #1a2a6c, #4a7bff);
            color: white;
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(26, 42, 108, 0.3);
            text-align: center;
        }
        
        .vip-status h2 {
            font-size: 22px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .vip-status h2 i {
            margin-right: 10px;
            color: gold;
        }
        
        .vip-status p {
            margin: 10px 0;
            font-size: 16px;
        }
        
        .vip-features {
            background-color: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .vip-features h3 {
            color: #1a2a6c;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .feature-list {
            list-style-type: none;
        }
        
        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .feature-list li i {
            margin-right: 10px;
            color: #4a7bff;
        }
        
        .feature-disabled {
            color: #999;
        }
        
        .feature-disabled i {
            color: #ccc !important;
        }
        
        .query-btn {
            background: linear-gradient(to right, #ff6b6b, #ff9e6b);
            margin-top: 20px;
        }
        
        /* 成绩主页样式 */
        .student-info {
            background: linear-gradient(135deg, #1a2a6c, #4a7bff);
            color: white;
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(26, 42, 108, 0.3);
        }
        
        .student-info h2 {
            font-size: 22px;
            margin-bottom: 10px;
        }
        
        .student-info p {
            margin: 5px 0;
            font-size: 16px;
        }
        
        .grades-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-radius: 15px;
            overflow: hidden;
        }
        
        .grades-table th {
            background-color: #1a2a6c;
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .grades-table tr:nth-child(even) {
            background-color: #f8f9ff;
        }
        
        .grades-table tr:hover {
            background-color: #eef2ff;
        }
        
        .grades-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .subject-cell {
            font-weight: 500;
        }
        
        .grade-cell {
            font-weight: 600;
            color: #1a2a6c;
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .success-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: fadeIn 0.5s, float 2s infinite 0.5s;
        }
        
        .error-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: fadeIn 0.5s;
        }
        
        .info-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4a7bff, #1a2a6c);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: fadeIn 0.5s;
        }
        
        .background-shapes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }
        
        .shape {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .shape:nth-child(1) {
            width: 300px;
            height: 300px;
            top: -150px;
            right: -150px;
        }
        
        .shape:nth-child(2) {
            width: 200px;
            height: 200px;
            bottom: -100px;
            left: -100px;
        }
        
        .shape:nth-child(3) {
            width: 150px;
            height: 150px;
            top: 30%;
            left: 20%;
        }
        
        .shape:nth-child(4) {
            width: 100px;
            height: 100px;
            bottom: 30%;
            right: 20%;
        }
        
        /* 分数颜色 */
        .excellent { color: #00c853; }
        .good { color: #ffab00; }
        .average { color: #ff6d00; }
        .poor { color: #dd2c00; }
        
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #f0f0f0;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: #e0e0e0;
            transform: translateX(-3px);
        }
        
        .exam-info {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9ff;
            border-radius: 15px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .exam-info p {
            margin: 5px 0;
            color: #555;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
            font-size: 14px;
        }
        
        .score-error {
            text-align: center;
            margin-top: 20px;
        }
        
        .score-error a {
            color: #4a7bff;
            text-decoration: none;
            font-size: 16px;
            cursor: pointer;
        }
        
        .score-error a:hover {
            text-decoration: underline;
        }
        
        /* 人机验证样式 */
        .captcha-container {
            margin: 20px 0;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 10px;
            text-align: center;
        }
        
        .captcha-text {
            font-size: 24px;
            letter-spacing: 5px;
            margin: 10px 0;
            font-weight: bold;
            color: #333;
            user-select: none;
        }
        
        .captcha-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
            margin-top: 10px;
        }
        
        .refresh-captcha {
            background: none;
            border: none;
            color: #4a7bff;
            font-size: 14px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .refresh-captcha:hover {
            text-decoration: underline;
        }
        
        /* 科目行样式 */
        .subject-row {
            position: relative;
            margin-bottom: 15px;
        }
        
        .delete-subject {
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            background: #ff4b2b;
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .subject-row:hover .delete-subject {
            opacity: 1;
        }
        
        .subject-input, .grade-input {
            width: calc(100% - 30px) !important;
        }
        
        /* 添加科目按钮样式 */
        .add-subject-btn {
            background: #5a6268;
            padding: 12px;
            margin-top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .add-subject-btn i {
            margin-right: 8px;
        }
        
        /* VIP标签 */
        .vip-tag {
            background: linear-gradient(135deg, #ff9a00, #ff6a00);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            margin-left: 10px;
            font-weight: bold;
        }
        
        /* 忘记密码链接 */
        .forgot-password {
            text-align: center;
            margin-top: 20px;
        }
        
        .forgot-password a {
            color: #4a7bff;
            text-decoration: none;
            font-size: 16px;
            cursor: pointer;
        }
        
        .forgot-password a:hover {
            text-decoration: underline;
        }
        
        /* 确认对话框 */
        .confirm-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .confirm-dialog.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .confirm-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .confirm-content h3 {
            margin-bottom: 20px;
            color: #1a2a6c;
        }
        
        .confirm-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        .confirm-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .confirm-yes {
            background: #4a7bff;
            color: white;
        }
        
        .confirm-no {
            background: #f0f0f0;
            color: #333;
        }
        
        .confirm-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="background-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>
    
    <!-- 确认对话框 -->
    <div class="confirm-dialog" id="confirmDialog">
        <div class="confirm-content">
            <h3>是否要进行忘记密码操作？</h3>
            <p>即将进行忘记密码操作</p>
            <div class="confirm-buttons">
                <button class="confirm-btn confirm-yes" id="confirmYes">是</button>
                <button class="confirm-btn confirm-no" id="confirmNo">否</button>
            </div>
        </div>
    </div>
    
    <div class="app-container">
        <!-- 成绩修改页面 -->
        <div class="page active" id="editScorePage">
            <div class="page-header">
                <div class="logo-container">
                    <div class="logo">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                </div>
                <h1>成绩修改系统</h1>
                <p>请输入需要修改的成绩信息</p>
            </div>
            
            <div class="form-group">
                <label for="studentName">学生姓名</label>
                <input type="text" id="studentName" class="form-control" placeholder="请输入学生姓名">
                <div class="error-text" id="studentNameError">请输入学生姓名</div>
            </div>
            
            <div class="form-group">
                <label for="studentId">学号</label>
                <input type="text" id="studentId" class="form-control" placeholder="请输入学号">
                <div class="error-text" id="studentIdError">请输入学号</div>
            </div>
            
            <div class="form-group">
                <label for="className">班级</label>
                <input type="text" id="className" class="form-control" placeholder="例如：高三(5)班">
                <div class="error-text" id="classNameError">请输入班级</div>
            </div>
            
            <div class="form-group">
                <label for="examName">考试名称</label>
                <input type="text" id="examName" class="form-control" placeholder="例如：期末模拟考试">
                <div class="error-text" id="examNameError">请输入考试名称</div>
            </div>
            
            <div class="form-group">
                <label for="examDate">考试时间</label>
                <input type="date" id="examDate" class="form-control">
                <div class="error-text" id="examDateError">请选择考试时间</div>
            </div>
            
            <div class="form-group">
                <label>科目成绩</label>
                <div id="subjectsContainer">
                    <div class="subject-row">
                        <input type="text" class="form-control subject-input" placeholder="科目名称" style="margin-bottom: 10px;">
                        <input type="number" step="0.1" class="form-control grade-input" placeholder="分数（小数）" style="margin-bottom: 15px;">
                        <button class="delete-subject"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="subject-row">
                        <input type="text" class="form-control subject-input" placeholder="科目名称" style="margin-bottom: 10px;">
                        <input type="number" step="0.1" class="form-control grade-input" placeholder="分数（小数）" style="margin-bottom: 15px;">
                        <button class="delete-subject"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <div class="error-text" id="subjectsError">请填写所有科目名称和分数</div>
                <button id="addSubject" class="btn add-subject-btn">
                    <i class="fas fa-plus"></i> 添加科目
                </button>
            </div>
            
            <button id="submitScores" class="btn">提交成绩</button>
            
            <div class="footer">
                <p>成绩系统 © 2023 版权所有</p>
            </div>
        </div>
        
        <!-- 登录页面 -->
        <div class="page" id="loginPage">
            <div class="page-header">
                <div class="logo-container">
                    <div class="logo">
                        <i class="fas fa-user-shield"></i>
                    </div>
                </div>
                <h1>用户登录</h1>
                <p>请输入您的账号信息</p>
            </div>
            
            <div class="form-group">
                <label for="username">用户名</label>
                <input type="text" id="username" class="form-control" placeholder="请输入用户名">
                <div class="error-text" id="usernameError">请输入用户名</div>
            </div>
            
            <div class="form-group">
                <label for="password">密码</label>
                <input type="password" id="password" class="form-control" placeholder="请输入密码">
                <div class="error-text" id="passwordError">请输入密码</div>
            </div>
            
            <!-- 人机验证 -->
            <div class="captcha-container">
                <p>请完成人机验证</p>
                <div class="captcha-text" id="captchaText">A7B9C</div>
                <input type="text" id="captchaInput" class="captcha-input" placeholder="请输入上方验证码">
                <div class="error-text" id="captchaError">验证码错误</div>
                <button class="refresh-captcha" id="refreshCaptcha">
                    <i class="fas fa-sync-alt"></i> 刷新验证码
                </button>
            </div>
            
            <button id="loginBtn" class="btn">登录系统</button>
            
            <div class="forgot-password">
                <a id="forgotPassword">忘记密码？</a>
            </div>
            
            <div class="footer">
                <p>成绩系统 © 2023 版权所有</p>
            </div>
        </div>
        
        <!-- VIP首页 -->
        <div class="page" id="vipHomePage">
            <button class="back-btn" id="backToLogin">
                <i class="fas fa-sign-out-alt"></i>
            </button>
            
            <div class="page-header">
                <div class="logo-container">
                    <div class="logo">
                        <i class="fas fa-crown"></i>
                    </div>
                </div>
                <h1>成绩查询系统</h1>
                <p>欢迎使用成绩查询</p>
            </div>
            
            <div class="vip-status">
                <h2><i class="fas fa-crown"></i> VIP状态 <span class="vip-tag">未开通</span></h2>
                <p>您当前不是VIP会员，无法享受高级功能</p>
                <p>开通VIP后可享受更多优质服务</p>
            </div>
            
            <div class="vip-features">
                <h3>VIP特权功能</h3>
                <ul class="feature-list">
                    <li class="feature-disabled"><i class="fas fa-chart-line"></i> 成绩趋势分析</li>
                    <li class="feature-disabled"><i class="fas fa-trophy"></i> 班级排名查看</li>
                    <li class="feature-disabled"><i class="fas fa-bell"></i> 成绩更新提醒</li>
                    <li class="feature-disabled"><i class="fas fa-download"></i> 成绩单导出</li>
                    <li class="feature-disabled"><i class="fas fa-history"></i> 历史成绩查询</li>
                </ul>
            </div>
            
            <button id="queryScore" class="btn query-btn">查询本次成绩</button>
            
            <div class="footer">
                <p>成绩系统 © 2023 版权所有</p>
            </div>
        </div>
        
        <!-- 成绩详情页 -->
        <div class="page" id="scoreDetailPage">
            <button class="back-btn" id="backToVipHome">
                <i class="fas fa-arrow-left"></i>
            </button>
            
            <div class="page-header">
                <div class="logo-container">
                    <div class="logo">
                        <i class="fas fa-chart-line"></i>
                    </div>
                </div>
                <h1>个人成绩单</h1>
                <p>您的考试成绩详情</p>
            </div>
            
            <div class="student-info">
                <h2 id="displayName">李明</h2>
                <p id="displayId">学号: 20230001</p>
                <p id="displayClass">班级: 高三(5)班</p>
            </div>
            
            <div class="exam-info">
                <p><strong>考试名称:</strong> <span id="displayExam">期末模拟考试</span></p>
                <p><strong>考试时间:</strong> <span id="displayDate">2023-06-15</span></p>
            </div>
            
            <table class="grades-table">
                <thead>
                    <tr>
                        <th>科目</th>
                        <th>成绩</th>
                    </tr>
                </thead>
                <tbody id="gradesTableBody">
                    <tr>
                        <td class="subject-cell">语文</td>
                        <td class="grade-cell excellent">92.5</td>
                    </tr>
                    <tr>
                        <td class="subject-cell">数学</td>
                        <td class="grade-cell excellent">95.0</td>
                    </tr>
                    <tr>
                        <td class="subject-cell">英语</td>
                        <td class="grade-cell good">88.0</td>
                    </tr>
                    <tr>
                        <td class="subject-cell">物理</td>
                        <td class="grade-cell average">76.5</td>
                    </tr>
                    <tr>
                        <td class="subject-cell">化学</td>
                        <td class="grade-cell good">85.0</td>
                    </tr>
                    <tr>
                        <td class="subject-cell">生物</td>
                        <td class="grade-cell excellent">90.5</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="score-error">
                <a id="scoreErrorLink">成绩有误？</a>
            </div>
            
            <div class="footer">
                <p>成绩系统 © 2023 版权所有</p>
            </div>
        </div>
    </div>
    
    <script>
        // 页面切换控制
        const pages = {
            editScore: document.getElementById('editScorePage'),
            login: document.getElementById('loginPage'),
            vipHome: document.getElementById('vipHomePage'),
            scoreDetail: document.getElementById('scoreDetailPage')
        };
        
        // 切换页面函数
        function showPage(page) {
            // 隐藏所有页面
            Object.values(pages).forEach(p => {
                p.classList.remove('active');
            });
            
            // 显示目标页面
            page.classList.add('active');
        }
        
        // 显示错误信息
        function showError(element, errorElement, message) {
            element.classList.add('error');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }
        
        // 隐藏错误信息
        function hideError(element, errorElement) {
            element.classList.remove('error');
            errorElement.style.display = 'none';
        }
        
        // 添加科目按钮
        document.getElementById('addSubject').addEventListener('click', function() {
            const container = document.getElementById('subjectsContainer');
            const newRow = document.createElement('div');
            newRow.className = 'subject-row';
            newRow.innerHTML = `
                <input type="text" class="form-control subject-input" placeholder="科目名称" style="margin-bottom: 10px;">
                <input type="number" step="0.1" class="form-control grade-input" placeholder="分数（小数）" style="margin-bottom: 15px;">
                <button class="delete-subject"><i class="fas fa-times"></i></button>
            `;
            container.appendChild(newRow);
            
            // 为新添加的删除按钮添加事件监听
            newRow.querySelector('.delete-subject').addEventListener('click', function() {
                container.removeChild(newRow);
            });
        });
        
        // 为初始删除按钮添加事件监听
        document.querySelectorAll('.delete-subject').forEach(btn => {
            btn.addEventListener('click', function() {
                this.parentElement.remove();
            });
        });
        
        // 提交成绩按钮
        document.getElementById('submitScores').addEventListener('click', function() {
            let isValid = true;
            
            // 验证学生姓名
            const studentName = document.getElementById('studentName');
            const studentNameError = document.getElementById('studentNameError');
            if (!studentName.value.trim()) {
                showError(studentName, studentNameError, '请输入学生姓名');
                isValid = false;
            } else {
                hideError(studentName, studentNameError);
            }
            
            // 验证学号
            const studentId = document.getElementById('studentId');
            const studentIdError = document.getElementById('studentIdError');
            if (!studentId.value.trim()) {
                showError(studentId, studentIdError, '请输入学号');
                isValid = false;
            } else {
                hideError(studentId, studentIdError);
            }
            
            // 验证班级
            const className = document.getElementById('className');
            const classNameError = document.getElementById('classNameError');
            if (!className.value.trim()) {
                showError(className, classNameError, '请输入班级');
                isValid = false;
            } else {
                hideError(className, classNameError);
            }
            
            // 验证考试名称
            const examName = document.getElementById('examName');
            const examNameError = document.getElementById('examNameError');
            if (!examName.value.trim()) {
                showError(examName, examNameError, '请输入考试名称');
                isValid = false;
            } else {
                hideError(examName, examNameError);
            }
            
            // 验证考试时间
            const examDate = document.getElementById('examDate');
            const examDateError = document.getElementById('examDateError');
            if (!examDate.value) {
                showError(examDate, examDateError, '请选择考试时间');
                isValid = false;
            } else {
                hideError(examDate, examDateError);
            }
            
            // 验证科目和成绩
            const subjectInputs = document.querySelectorAll('.subject-input');
            const gradeInputs = document.querySelectorAll('.grade-input');
            const subjectsError = document.getElementById('subjectsError');
            let hasSubjects = false;
            let allFilled = true;
            
            for (let i = 0; i < subjectInputs.length; i++) {
                if (subjectInputs[i].value.trim() && gradeInputs[i].value.trim()) {
                    hasSubjects = true;
                } else if (subjectInputs[i].value.trim() || gradeInputs[i].value.trim()) {
                    allFilled = false;
                }
            }
            
            if (!hasSubjects) {
                subjectsError.textContent = '请至少添加一个完整科目';
                subjectsError.style.display = 'block';
                isValid = false;
            } else if (!allFilled) {
                subjectsError.textContent = '请填写所有科目名称和分数';
                subjectsError.style.display = 'block';
                isValid = false;
            } else {
                subjectsError.style.display = 'none';
            }
            
            if (!isValid) {
                showMessage('请填写完整信息！', 'error');
                return;
            }
            
            // 显示成功消息
            showMessage('成绩提交成功！');
            
            // 模拟提交过程
            setTimeout(() => {
                showPage(pages.login);
            }, 1500);
        });
        
        // 生成随机验证码
        function generateCaptcha() {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let captcha = '';
            for (let i = 0; i < 5; i++) {
                captcha += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return captcha;
        }
        
        // 设置验证码
        let currentCaptcha = generateCaptcha();
        document.getElementById('captchaText').textContent = currentCaptcha;
        
        // 刷新验证码按钮
        document.getElementById('refreshCaptcha').addEventListener('click', function() {
            currentCaptcha = generateCaptcha();
            document.getElementById('captchaText').textContent = currentCaptcha;
            document.getElementById('captchaInput').value = '';
            hideError(document.getElementById('captchaInput'), document.getElementById('captchaError'));
        });
        
        // 登录按钮
        document.getElementById('loginBtn').addEventListener('click', function() {
            let isValid = true;
            
            // 验证用户名
            const username = document.getElementById('username');
            const usernameError = document.getElementById('usernameError');
            if (!username.value.trim()) {
                showError(username, usernameError, '请输入用户名');
                isValid = false;
            } else {
                hideError(username, usernameError);
            }
            
            // 验证密码
            const password = document.getElementById('password');
            const passwordError = document.getElementById('passwordError');
            if (!password.value.trim()) {
                showError(password, passwordError, '请输入密码');
                isValid = false;
            } else {
                hideError(password, passwordError);
            }
            
            // 验证验证码
            const captchaInput = document.getElementById('captchaInput');
            const captchaError = document.getElementById('captchaError');
            if (!captchaInput.value.trim()) {
                showError(captchaInput, captchaError, '请输入验证码');
                isValid = false;
            } else if (captchaInput.value !== currentCaptcha) {
                showError(captchaInput, captchaError, '验证码错误');
                isValid = false;
            } else {
                hideError(captchaInput, captchaError);
            }
            
            if (!isValid) {
                return;
            }
            
            // 显示成功消息
            showMessage('登录成功！欢迎使用成绩系统');
            
            // 模拟登录过程
            setTimeout(() => {
                showPage(pages.vipHome);
            }, 1500);
        });
        
        // 查询成绩按钮
        document.getElementById('queryScore').addEventListener('click', function() {
            // 更新主页显示的信息
            document.getElementById('displayName').textContent = 
                document.getElementById('studentName').value || '李明';
            document.getElementById('displayId').textContent = 
                '学号: ' + (document.getElementById('studentId').value || '20230001');
            document.getElementById('displayClass').textContent = 
                '班级: ' + (document.getElementById('className').value || '高三(5)班');
            document.getElementById('displayExam').textContent = 
                document.getElementById('examName').value || '期末模拟考试';
            document.getElementById('displayDate').textContent = 
                document.getElementById('examDate').value || '2023-06-15';
            
            // 更新成绩表格
            updateGradesTable();
            
            // 切换到成绩详情页
            showPage(pages.scoreDetail);
        });
        
        // 成绩有误链接
        document.getElementById('scoreErrorLink').addEventListener('click', function() {
            showMessage('已是最新成绩！', 'info');
        });
        
        // 忘记密码链接
        document.getElementById('forgotPassword').addEventListener('click', function() {
            document.getElementById('confirmDialog').classList.add('active');
        });
        
        // 确认对话框按钮
        document.getElementById('confirmYes').addEventListener('click', function() {
            document.getElementById('confirmDialog').classList.remove('active');
            showMessage('服务器繁忙，请稍后再试！', 'error');
        });
        
        document.getElementById('confirmNo').addEventListener('click', function() {
            document.getElementById('confirmDialog').classList.remove('active');
        });
        
        // 更新成绩表格函数
        function updateGradesTable() {
            const tbody = document.getElementById('gradesTableBody');
            tbody.innerHTML = '';
            
            const subjectInputs = document.querySelectorAll('.subject-input');
            const gradeInputs = document.querySelectorAll('.grade-input');
            
            for (let i = 0; i < subjectInputs.length; i++) {
                const subject = subjectInputs[i].value.trim() || `科目${i+1}`;
                const grade = gradeInputs[i].value.trim() || (Math.random() * 50 + 50).toFixed(1);
                
                if (!subject) continue;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="subject-cell">${subject}</td>
                    <td class="grade-cell">${grade}</td>
                `;
                tbody.appendChild(row);
            }
            
            // 更新成绩颜色
            updateGradeColors();
        }
        
        // 返回按钮
        document.getElementById('backToLogin').addEventListener('click', function() {
            showPage(pages.login);
        });
        
        document.getElementById('backToVipHome').addEventListener('click', function() {
            showPage(pages.vipHome);
        });
        
        // 显示消息函数
        function showMessage(message, type = 'success') {
            const msgEl = document.createElement('div');
            msgEl.className = `${type}-message`;
            msgEl.textContent = message;
            
            document.body.appendChild(msgEl);
            
            setTimeout(() => {
                msgEl.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(msgEl);
                }, 500);
            }, 2500);
        }
        
        // 初始化日期为今天
        document.getElementById('examDate').valueAsDate = new Date();
        
        // 根据分数设置颜色类
        function updateGradeColors() {
            document.querySelectorAll('.grade-cell').forEach(cell => {
                const grade = parseFloat(cell.textContent);
                cell.className = 'grade-cell ';
                
                if (grade >= 90) cell.className += 'excellent';
                else if (grade >= 80) cell.className += 'good';
                else if (grade >= 70) cell.className += 'average';
                else cell.className += 'poor';
            });
        }
        
        // 初始更新成绩颜色
        updateGradeColors();
    </script>
</body>
</html>