<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>云成绩高级版</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind CSS -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        danger: '#EF4444',
                        warning: '#F59E0B',
                        info: '#6366F1',
                        dark: '#1F2937',
                        light: '#F3F4F6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .bg-gradient-blue {
                background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 100%);
            }
            .bg-gradient-green {
                background: linear-gradient(135deg, #10B981 0%, #34D399 100%);
            }
            .bg-gradient-red {
                background: linear-gradient(135deg, #EF4444 0%, #F87171 100%);
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease;
            }
            .card-shadow {
                box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1);
            }
        }
    </style>
    
    <style>
        /* 全局样式 */
        body {
            font-family: 'Inter', system-ui, sans-serif;
            overflow-x: hidden;
            background-color: #F3F4F6;
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        .animate-slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }
        
        .animate-pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* 滑块验证样式 */
        .slider-container {
            width: 100%;
            height: 50px;
            background-color: #F3F4F6;
            border-radius: 25px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .slider-track {
            height: 100%;
            background-color: #D1D5DB;
            position: relative;
        }
        
        .slider-handle {
            width: 50px;
            height: 50px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .slider-handle:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        /* 加载动画 */
        .loader {
            border: 3px solid #F3F4F6;
            border-top: 3px solid #3B82F6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #F3F4F6;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #9CA3AF;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #6B7280;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- 服务器连接提示页面 -->
    <div id="serverConnection" class="fixed inset-0 bg-gradient-blue flex flex-col items-center justify-center text-white z-50">
        <div class="w-20 h-20 mb-6 animate-pulse">
            <i class="fa fa-cloud-upload text-6xl" aria-hidden="true"></i>
        </div>
        <h1 class="text-3xl font-bold mb-4 text-shadow">正在连接服务器</h1>
        <p class="text-lg opacity-90 mb-6">请稍后...</p>
        <div class="loader"></div>
    </div>

    <!-- 公告弹窗 -->
    <div id="announcementModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl animate-fade-in">
            <h2 class="text-xl font-bold text-primary mb-4">重要公告</h2>
            <div class="space-y-3 mb-6 text-gray-700">
                <p>1. 本应用不会收集个人信息，请放心填写。</p>
                <p>2. 教师端负责录入成绩，学生端只能查询成绩。</p>
                <p>3. 请妥善保管您的账号密码，避免泄露。</p>
                <p>4. 如有任何问题，请联系系统管理员。</p>
            </div>
            <div class="flex justify-end">
                <button id="closeAnnouncement" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-all-300">
                    已阅读
                </button>
            </div>
        </div>
    </div>

    <!-- 登录页面 -->
    <div id="loginPage" class="min-h-screen flex relative overflow-hidden hidden">
        <!-- 蓝白渐变背景 -->
        <div class="absolute inset-0 bg-gradient-to-br from-blue-500 to-white"></div>
        
        <!-- 公告按钮 -->
        <button id="announcementBtn" class="absolute top-6 left-6 bg-white/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-all-300 z-10">
            <i class="fa fa-bullhorn mr-2" aria-hidden="true"></i>公告
        </button>
        
        <!-- 登录表单容器 -->
        <div class="ml-auto w-full max-w-md bg-white/95 backdrop-blur-lg h-screen flex flex-col animate-slide-in">
            <div class="p-8 flex-1">
                <!-- 标题 -->
                <div class="mb-10 text-center">
                    <h1 class="text-3xl font-bold text-primary">云成绩高级版</h1>
                    <p class="text-gray-500 mt-2">高效管理和查询学生成绩</p>
                </div>
                
                <!-- 登录类型选择 -->
                <div class="relative flex rounded-lg overflow-hidden mb-8 border border-gray-200 transition-all duration-300">
                    <!-- 滑动指示器 -->
                    <div id="loginTypeIndicator" class="absolute inset-y-0 left-0 w-1/2 bg-primary transition-transform duration-300 rounded-lg"></div>
                    
                    <!-- 按钮 -->
                    <button id="studentLoginBtn" class="relative z-10 flex-1 py-3 text-center font-medium text-white transition-all duration-300">
                        学生端
                    </button>
                    <button id="teacherLoginBtn" class="relative z-10 flex-1 py-3 text-center font-medium text-gray-600 transition-all duration-300">
                        教师/管理端
                    </button>
                </div>
                
                <!-- 登录表单 -->
                <form id="loginForm" class="space-y-5">
                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                        <input type="text" id="username" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入用户名">
                    </div>
                    
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                        <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入密码">
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <button type="button" id="forgotPasswordBtn" class="text-sm text-primary hover:text-primary/80 transition-all-300">
                            忘记密码？
                        </button>
                    </div>
                    
                    <button type="submit" class="w-full bg-gradient-blue text-white py-3 rounded-lg font-medium hover:opacity-90 transition-all-300">
                        登录
                    </button>
                </form>
                
                <!-- 教师端注册按钮 -->
                <div class="text-center mt-6">
                    <span class="text-gray-600">还没有账号？</span>
                    <button id="teacherRegisterBtn" class="text-primary font-medium hover:text-primary/80 transition-all-300">
                        立即注册
                    </button>
                </div>
            </div>
            
            <!-- 页脚 -->
            <div class="p-4 border-t border-gray-200 text-center text-gray-500 text-sm">
                © 2026 云成绩高级版 版权所有
            </div>
        </div>
    </div>

    <!-- 教师注册页面 -->
    <div id="teacherRegisterPage" class="min-h-screen flex relative overflow-hidden hidden">
        <!-- 蓝白渐变背景 -->
        <div class="absolute inset-0 bg-gradient-to-br from-blue-500 to-white"></div>
        
        <!-- 返回按钮 -->
        <button id="backToLoginBtn" class="absolute top-6 left-6 bg-white/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-all-300 z-10">
            <i class="fa fa-arrow-left mr-2" aria-hidden="true"></i>返回
        </button>
        
        <!-- 注册表单容器 -->
        <div class="ml-auto w-full max-w-md bg-white/95 backdrop-blur-lg h-screen flex flex-col animate-slide-in">
            <div class="p-8 flex-1">
                <!-- 标题 -->
                <div class="mb-10 text-center">
                    <h1 class="text-3xl font-bold text-primary">教师注册</h1>
                    <p class="text-gray-500 mt-2">创建您的教师账号</p>
                </div>
                
                <!-- 注册表单 -->
                <form id="registerForm" class="space-y-5">
                    <div>
                        <label for="registerUsername" class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                        <input type="text" id="registerUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入用户名">
                    </div>
                    
                    <div>
                        <label for="registerPassword" class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                        <input type="password" id="registerPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请设置密码">
                    </div>
                    
                    <div>
                        <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">确认密码</label>
                        <input type="password" id="confirmPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请再次输入密码">
                    </div>
                    
                    <div>
                        <label for="invitationCode" class="block text-sm font-medium text-gray-700 mb-1">邀请码 <span class="text-red-500">*</span></label>
                        <input type="text" id="invitationCode" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入邀请码">
                    </div>
                    
                    <!-- 滑块验证 -->
                    <div id="sliderVerification" class="hidden">
                        <p class="text-center text-gray-700 mb-2">请完成滑块验证</p>
                        <div class="slider-container" id="sliderContainer">
                            <div class="slider-track"></div>
                            <div class="slider-handle" id="sliderHandle">
                                <i class="fa fa-angle-right text-primary" aria-hidden="true"></i>
                            </div>
                        </div>
                        <p id="verificationMessage" class="text-center text-gray-500 text-sm mt-2">请向右拖动滑块完成验证</p>
                    </div>
                    
                    <button type="submit" class="w-full bg-gradient-blue text-white py-3 rounded-lg font-medium hover:opacity-90 transition-all-300">
                        下一步
                    </button>
                </form>
            </div>
            
            <!-- 页脚 -->
            <div class="p-4 border-t border-gray-200 text-center text-gray-500 text-sm">
                © 2026 云成绩高级版 版权所有
            </div>
        </div>
    </div>

    <!-- 教师成绩录入页面 -->
    <div id="teacherScorePage" class="min-h-screen bg-gray-50 hidden">
        <!-- 顶部导航 -->
        <header class="bg-white shadow-md">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <h1 class="text-xl font-bold text-primary">成绩录入</h1>
                <button id="teacherLogoutBtn" class="text-gray-600 hover:text-primary transition-all-300">
                    <i class="fa fa-sign-out mr-1" aria-hidden="true"></i>退出
                </button>
            </div>
        </header>
        
        <!-- 主内容 -->
        <main class="container mx-auto px-4 py-6">
            <!-- 学生信息表单 -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6 card-shadow">
                <h2 class="text-lg font-bold text-gray-800 mb-4">学生信息</h2>
                <form id="studentInfoForm" class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div>
                        <label for="studentName" class="block text-sm font-medium text-gray-700 mb-1">学生姓名</label>
                        <input type="text" id="studentName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入学生姓名">
                    </div>
                    
                    <div>
                        <label for="studentId" class="block text-sm font-medium text-gray-700 mb-1">考号</label>
                        <input type="text" id="studentId" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入考号">
                    </div>
                    
                    <div>
                        <label for="examName" class="block text-sm font-medium text-gray-700 mb-1">考试名称</label>
                        <input type="text" id="examName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入考试名称">
                    </div>
                    
                    <div>
                        <label for="schoolName" class="block text-sm font-medium text-gray-700 mb-1">学校名称</label>
                        <input type="text" id="schoolName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入学校名称">
                    </div>
                    
                    <div class="md:col-span-2">
                        <label for="examDate" class="block text-sm font-medium text-gray-700 mb-1">考试时间</label>
                        <input type="date" id="examDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300">
                    </div>
                </form>
            </div>
            
            <!-- 成绩录入 -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6 card-shadow">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">成绩录入</h2>
                    <button id="addSubjectBtn" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-all-300">
                        <i class="fa fa-plus mr-1" aria-hidden="true"></i>添加科目
                    </button>
                </div>
                
                <div id="subjectsContainer" class="space-y-4">
                    <!-- 科目模板 -->
                    <div class="subject-row flex items-center gap-4 p-4 bg-gray-50 rounded-lg">
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-1">科目名称</label>
                            <input type="text" class="subject-name w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入科目名称">
                        </div>
                        <div class="w-1/3">
                            <label class="block text-sm font-medium text-gray-700 mb-1">分数</label>
                            <input type="number" step="0.1" class="subject-score w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入分数">
                        </div>
                        <button class="delete-subject-btn text-danger hover:text-danger/80 transition-all-300" disabled>
                            <i class="fa fa-times text-xl" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 提交按钮 -->
            <div class="text-center">
                <button id="submitScoreBtn" class="bg-gradient-green text-white px-8 py-3 rounded-lg font-medium hover:opacity-90 transition-all-300">
                    提交成绩
                </button>
            </div>
        </main>
        
        <!-- 开通会员浮动按钮 -->
        <button id="openMemberBtn" class="fixed bottom-6 right-6 bg-gradient-blue text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center text-xl hover:scale-110 transition-all duration-300 z-40">
            <i class="fa fa-crown" aria-hidden="true"></i>
        </button>
    </div>
    
    <!-- 会员购买弹窗 -->
    <div id="memberPurchaseModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl animate-fade-in">
            <div class="text-center mb-6">
                <i class="fa fa-crown text-4xl text-yellow-500" aria-hidden="true"></i>
                <h3 class="text-xl font-bold mt-2">开通高级会员</h3>
                <p class="text-gray-500 mt-1">解锁更多成绩分析功能</p>
            </div>
            
            <!-- 会员选项 -->
            <div class="space-y-4 mb-6">
                <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:border-primary transition-all duration-300 member-option" data-period="half" data-price="30">
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-medium">半学期会员</h4>
                            <p class="text-sm text-gray-500">有效期180天</p>
                        </div>
                        <div class="text-primary font-bold">¥30</div>
                    </div>
                </div>
                
                <div class="border border-primary rounded-lg p-4 cursor-pointer bg-primary/5 member-option active" data-period="full" data-price="54">
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-medium">一学期会员</h4>
                            <p class="text-sm text-gray-500">有效期365天</p>
                        </div>
                        <div>
                            <span class="text-primary font-bold">¥54</span>
                            <span class="ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded">9折</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 支付方式 -->
            <div class="mb-6">
                <h4 class="font-medium mb-3">支付方式</h4>
                <div class="grid grid-cols-2 gap-3">
                    <div class="border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-primary transition-all duration-300 payment-option active" data-method="wechat">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fa fa-weixin text-2xl text-green-500 mr-2" aria-hidden="true"></i>
                                <span>微信支付</span>
                            </div>
                            <i class="fa fa-check-circle text-primary"></i>
                        </div>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-primary transition-all duration-300 payment-option" data-method="alipay">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fa fa-credit-card text-2xl text-blue-500 mr-2" aria-hidden="true"></i>
                                <span>支付宝</span>
                            </div>
                            <i class="fa fa-circle text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 支付按钮 -->
            <button id="confirmPaymentBtn" class="w-full bg-gradient-blue text-white py-3 rounded-lg font-medium hover:opacity-90 transition-all duration-300">
                立即支付 ¥54
            </button>
            
            <!-- 取消按钮 -->
            <button id="cancelPaymentBtn" class="w-full mt-3 text-gray-600 py-2 rounded-lg hover:bg-gray-100 transition-all duration-300">
                取消
            </button>
        </div>
    </div>

    <!-- 学生主页 -->
    <div id="studentHomePage" class="min-h-screen bg-gray-50 hidden">
        <!-- 顶部导航 -->
        <header class="bg-white shadow-md">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <h1 class="text-xl font-bold text-primary">云成绩高级版</h1>
                <button id="studentLogoutBtn" class="text-gray-600 hover:text-primary transition-all-300">
                    <i class="fa fa-sign-out mr-1" aria-hidden="true"></i>退出
                </button>
            </div>
        </header>
        
        <!-- 主内容 -->
        <main class="container mx-auto px-4 py-6">
            <!-- 学生信息卡片 -->
            <div class="bg-gradient-blue text-white rounded-xl shadow-lg p-6 mb-6 card-shadow">
                <div class="flex flex-col md:flex-row md:items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold mb-2" id="studentDisplayName">学生姓名</h2>
                        <div class="flex flex-wrap gap-4">
                            <p class="text-white/90"><i class="fa fa-id-card mr-1" aria-hidden="true"></i> <span id="studentDisplayId">考号</span></p>
                            <p class="text-white/90"><i class="fa fa-university mr-1" aria-hidden="true"></i> <span id="studentDisplaySchool">学校</span></p>
                        </div>
                    </div>
                    <div class="mt-4 md:mt-0 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg">
                        <i class="fa fa-crown mr-1" aria-hidden="true"></i>会员功能
                        <div id="memberFeatures" class="hidden mt-2 p-3 bg-white/10 rounded-lg text-sm">
                            <ul class="list-disc pl-5 space-y-1">
                                <li>查看历史考试成绩趋势分析</li>
                                <li>获取学科知识点掌握度评估</li>
                                <li>下载打印高清版成绩单</li>
                                <li>接收成绩进步提醒</li>
                                <li>与同学成绩匿名对比分析</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 功能区域 -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6 card-shadow">
                <h2 class="text-lg font-bold text-gray-800 mb-4">个人成绩单</h2>
                <p class="text-gray-500 mb-6">点击下方按钮查询您的最新成绩</p>
                
                <div class="text-center">
                    <button id="queryScoreBtn" class="bg-gradient-blue text-white px-8 py-3 rounded-lg font-medium hover:opacity-90 transition-all-300">
                        <i class="fa fa-search mr-2" aria-hidden="true"></i>查询成绩
                    </button>
                </div>
            </div>
            
            <!-- 成绩展示区域 -->
            <div id="scoreDisplayArea" class="hidden">
                <!-- 考试信息 -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6 card-shadow">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">考试信息</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <p class="text-gray-700"><span class="font-medium">考试名称：</span> <span id="examDisplay"></span></p>
                        <p class="text-gray-700"><span class="font-medium">考试时间：</span> <span id="dateDisplay"></span></p>
                    </div>
                </div>
                
                <!-- 成绩表格 -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6 card-shadow">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">成绩详情</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">科目</th>
                                    <th class="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">分数</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="scoresTableBody">
                                <!-- 成绩行将通过JavaScript动态添加 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 提示消息（从右侧滑入） -->
    <div id="messageToast" class="fixed top-4 right-0 transform translate-x-full z-50 flex items-center p-4 rounded-lg shadow-xl transition-all duration-300 ease-out max-w-sm">
        <i id="messageIcon" class="fa fa-info-circle text-xl text-white mr-3" aria-hidden="true"></i>
        <div>
            <h3 id="messageTitle" class="font-bold text-white mb-1">提示</h3>
            <p id="messageContent" class="text-white/90">提示内容</p>
        </div>
    </div>

    <!-- 提交确认弹窗 -->
    <div id="confirmModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl animate-fade-in">
            <div class="text-center mb-4">
                <i class="fa fa-exclamation-triangle text-4xl text-warning" aria-hidden="true"></i>
            </div>
            <h3 class="text-xl font-bold text-center mb-3">确认提交</h3>
            <p class="text-gray-700 text-center mb-6">提交成绩后不可更改，是否确认提交？</p>
            <div class="flex justify-center gap-4">
                <button id="cancelConfirmBtn" class="bg-gray-300 text-gray-800 px-6 py-2 rounded-lg hover:bg-gray-400 transition-all-300">
                    取消
                </button>
                <button id="confirmSubmitBtn" class="bg-danger text-white px-6 py-2 rounded-lg hover:bg-danger/90 transition-all-300">
                    确认
                </button>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let currentLoginType = 'student'; // 当前登录类型
        let hasReadAnnouncement = false; // 是否已阅读公告
        let isTeacherScoreSubmitted = false; // 教师是否已提交成绩
        let registeredTeachers = []; // 已注册的教师账号
        let studentScores = null; // 学生成绩数据
        let verificationType = ''; // 验证类型：'login' 或 'register'
        
        // DOM元素
        const serverConnectionPage = document.getElementById('serverConnection');
        const loginPage = document.getElementById('loginPage');
        const teacherRegisterPage = document.getElementById('teacherRegisterPage');
        const teacherScorePage = document.getElementById('teacherScorePage');
        const studentHomePage = document.getElementById('studentHomePage');
        const announcementModal = document.getElementById('announcementModal');
        const messageModal = document.getElementById('messageModal');
        const confirmModal = document.getElementById('confirmModal');
        
        // 登录类型切换
        const loginTypeIndicator = document.getElementById('loginTypeIndicator');
        
        document.getElementById('studentLoginBtn').addEventListener('click', function() {
            currentLoginType = 'student';
            // 移动指示器
            loginTypeIndicator.style.transform = 'translateX(0)';
            // 更新文本颜色
            this.classList.remove('text-gray-600');
            this.classList.add('text-white');
            document.getElementById('teacherLoginBtn').classList.remove('text-white');
            document.getElementById('teacherLoginBtn').classList.add('text-gray-600');
        });
        
        document.getElementById('teacherLoginBtn').addEventListener('click', function() {
            currentLoginType = 'teacher';
            // 移动指示器
            loginTypeIndicator.style.transform = 'translateX(100%)';
            // 更新文本颜色
            this.classList.remove('text-gray-600');
            this.classList.add('text-white');
            document.getElementById('studentLoginBtn').classList.remove('text-white');
            document.getElementById('studentLoginBtn').classList.add('text-gray-600');
        });
        
        // 公告相关
        document.getElementById('announcementBtn').addEventListener('click', function() {
            announcementModal.classList.remove('hidden');
        });
        
        document.getElementById('closeAnnouncement').addEventListener('click', function() {
            announcementModal.classList.add('hidden');
            hasReadAnnouncement = true;
        });
        
        // 页面切换
        function showPage(page) {
            // 隐藏所有页面
            loginPage.classList.add('hidden');
            teacherRegisterPage.classList.add('hidden');
            teacherScorePage.classList.add('hidden');
            studentHomePage.classList.add('hidden');
            
            // 显示目标页面
            page.classList.remove('hidden');
        }
        
        // 服务器连接后跳转到登录页面
        setTimeout(function() {
            serverConnectionPage.classList.add('hidden');
            showPage(loginPage);
        }, 1500);
        
        // 教师注册相关
        document.getElementById('teacherRegisterBtn').addEventListener('click', function() {
            // 检查当前登录类型
            if (currentLoginType === 'student') {
                // 学生端点击注册时显示提示
                showMessage('此功能仅限学校端可用，学生端目前不支持', 'warning');
            } else {
                // 教师/管理端点击注册时显示注册页面
                showPage(teacherRegisterPage);
            }
        });
        
        document.getElementById('backToLoginBtn').addEventListener('click', function() {
            showPage(loginPage);
        });
        
        // 注册表单提交
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // 获取邀请码
            const invitationCode = document.getElementById('invitationCode').value;
            
            // 验证表单
            if (!username || !password || !confirmPassword || !invitationCode) {
                showMessage('请填写完整信息', 'warning');
                return;
            }
            
            // 验证邀请码
            if (invitationCode !== 'YCJ426KE') {
                showMessage('邀请码不正确', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showMessage('两次输入的密码不一致', 'warning');
                return;
            }
            
            // 检查是否已阅读公告
            if (!hasReadAnnouncement) {
                showMessage('连接服务器失败', 'error');
                return;
            }
            
            // 设置验证类型为注册
            verificationType = 'register';
            
            // 显示滑块验证
            document.getElementById('sliderVerification').classList.remove('hidden');
        });
        
        // 滑块验证逻辑
        const sliderContainer = document.getElementById('sliderContainer');
        const sliderHandle = document.getElementById('sliderHandle');
        const verificationMessage = document.getElementById('verificationMessage');
        let isDragging = false;
        
        sliderHandle.addEventListener('mousedown', function(e) {
            isDragging = true;
            e.preventDefault();
        });
        
        sliderHandle.addEventListener('touchstart', function(e) {
            isDragging = true;
            e.preventDefault();
        });
        
        document.addEventListener('mousemove', function(e) {
            if (!isDragging) return;
            moveSlider(e.clientX);
        });
        
        document.addEventListener('touchmove', function(e) {
            if (!isDragging) return;
            moveSlider(e.touches[0].clientX);
        });
        
        document.addEventListener('mouseup', function() {
            if (!isDragging) return;
            isDragging = false;
            checkVerification();
        });
        
        document.addEventListener('touchend', function() {
            if (!isDragging) return;
            isDragging = false;
            checkVerification();
        });
        
        function moveSlider(x) {
            const containerRect = sliderContainer.getBoundingClientRect();
            let newPosition = x - containerRect.left;
            
            // 限制在容器范围内
            newPosition = Math.max(0, Math.min(newPosition, containerRect.width - sliderHandle.offsetWidth));
            
            sliderHandle.style.left = newPosition + 'px';
        }
        
        function checkVerification() {
            const containerRect = sliderContainer.getBoundingClientRect();
            const handlePosition = parseInt(sliderHandle.style.left) || 0;
            
            // 验证是否滑动到足够距离
            if (handlePosition > containerRect.width - 100) {
                // 验证成功
                sliderHandle.innerHTML = '<i class="fa fa-check text-secondary" aria-hidden="true"></i>';
                sliderHandle.style.backgroundColor = '#10B981';
                sliderHandle.style.color = 'white';
                verificationMessage.textContent = '验证成功';
                verificationMessage.style.color = '#10B981';
                
                setTimeout(function() {
                    if (verificationType === 'register') {
                        // 注册流程
                        // 保存教师信息
                        const username = document.getElementById('registerUsername').value;
                        const password = document.getElementById('registerPassword').value;
                        registeredTeachers.push({ username, password });
                        
                        // 注册成功提示
                        showMessage('注册成功', 'success');
                        // 返回登录页面
                        setTimeout(function() {
                            showPage(loginPage);
                            // 切换到教师登录
                            document.getElementById('teacherLoginBtn').click();
                            // 重置表单
                            document.getElementById('registerForm').reset();
                            resetSliderVerification();
                        }, 1500);
                    } else if (verificationType === 'login') {
                        // 登录流程
                        const username = document.getElementById('username').value;
                        const password = document.getElementById('password').value;
                        
                        if (currentLoginType === 'student') {
                            // 学生登录
                            if (!isTeacherScoreSubmitted) {
                                showMessage('网络异常', 'error');
                                resetSliderVerification();
                                return;
                            }
                            
                            // 检查是否有对应的教师账号
                            const teacherExists = registeredTeachers.some(teacher => 
                                teacher.username === username && teacher.password === password
                            );
                            
                            if (teacherExists) {
                                // 登录成功，进入学生主页
                                showPage(studentHomePage);
                                // 显示学生信息
                                if (studentScores) {
                                    document.getElementById('studentDisplayName').textContent = studentScores.studentName;
                                    document.getElementById('studentDisplayId').textContent = studentScores.studentId;
                                    document.getElementById('studentDisplaySchool').textContent = studentScores.schoolName;
                                }
                            } else {
                                showMessage('用户名或密码错误', 'error');
                            }
                        } else {
                            // 教师登录
                            const teacherExists = registeredTeachers.some(teacher => 
                                teacher.username === username && teacher.password === password
                            );
                            
                            if (teacherExists) {
                                // 登录成功，进入成绩录入页面
                                showPage(teacherScorePage);
                            } else {
                                showMessage('用户名或密码错误', 'error');
                            }
                        }
                        
                        // 重置滑块验证
                        resetSliderVerification();
                    }
                }, 500);
            } else {
                // 验证失败，重置
                sliderHandle.style.left = '0';
                verificationMessage.textContent = '请向右拖动滑块完成验证';
            }
        }
        
        // 重置滑块验证
        function resetSliderVerification() {
            document.getElementById('sliderVerification').classList.add('hidden');
            sliderHandle.style.left = '0';
            sliderHandle.innerHTML = '<i class="fa fa-angle-right text-primary" aria-hidden="true"></i>';
            sliderHandle.style.backgroundColor = 'white';
            verificationMessage.textContent = '请向右拖动滑块完成验证';
            verificationMessage.style.color = '#6B7280';
        }
        
        // 登录表单提交
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // 验证表单
            if (!username || !password) {
                showMessage('请填写完整信息', 'warning');
                return;
            }
            
            // 检查是否已阅读公告
            if (!hasReadAnnouncement) {
                showMessage('连接服务器失败', 'error');
                return;
            }
            
            // 设置验证类型为登录
            verificationType = 'login';
            
            // 显示滑块验证
            document.getElementById('sliderVerification').classList.remove('hidden');
        });
        
        // 忘记密码
        document.getElementById('forgotPasswordBtn').addEventListener('click', function() {
            if (currentLoginType === 'student') {
                showMessage('请联系班主任及学校', 'info');
            } else {
                showMessage('请联系系统管理员', 'info');
            }
        });
        
        // 教师端添加科目
        document.getElementById('addSubjectBtn').addEventListener('click', function() {
            const subjectsContainer = document.getElementById('subjectsContainer');
            const subjectRows = subjectsContainer.querySelectorAll('.subject-row');
            
            // 如果已经有至少一个科目，则启用删除按钮
            if (subjectRows.length >= 1) {
                subjectRows.forEach(row => {
                    const deleteBtn = row.querySelector('.delete-subject-btn');
                    deleteBtn.removeAttribute('disabled');
                    deleteBtn.classList.remove('text-gray-400');
                    deleteBtn.classList.add('text-danger');
                });
            }
            
            // 创建新的科目行
            const newSubjectRow = document.createElement('div');
            newSubjectRow.className = 'subject-row flex items-center gap-4 p-4 bg-gray-50 rounded-lg';
            newSubjectRow.innerHTML = `
                <div class="flex-1">
                    <label class="block text-sm font-medium text-gray-700 mb-1">科目名称</label>
                    <input type="text" class="subject-name w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入科目名称">
                </div>
                <div class="w-1/3">
                    <label class="block text-sm font-medium text-gray-700 mb-1">分数</label>
                    <input type="number" step="0.1" class="subject-score w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all-300" placeholder="请输入分数">
                </div>
                <button class="delete-subject-btn text-danger hover:text-danger/80 transition-all-300">
                    <i class="fa fa-times text-xl" aria-hidden="true"></i>
                </button>
            `;
            
            // 添加删除事件
            newSubjectRow.querySelector('.delete-subject-btn').addEventListener('click', function() {
                newSubjectRow.remove();
                
                // 如果只剩下一个科目，则禁用删除按钮
                const remainingRows = document.querySelectorAll('.subject-row');
                if (remainingRows.length === 1) {
                    const deleteBtn = remainingRows[0].querySelector('.delete-subject-btn');
                    deleteBtn.setAttribute('disabled', 'disabled');
                    deleteBtn.classList.remove('text-danger');
                    deleteBtn.classList.add('text-gray-400');
                }
            });
            
            subjectsContainer.appendChild(newSubjectRow);
        });
        
        // 提交成绩按钮
        document.getElementById('submitScoreBtn').addEventListener('click', function() {
            // 显示确认弹窗
            confirmModal.classList.remove('hidden');
        });
        
        // 确认提交
        document.getElementById('confirmSubmitBtn').addEventListener('click', function() {
            // 收集学生信息
            const studentName = document.getElementById('studentName').value;
            const studentId = document.getElementById('studentId').value;
            const examName = document.getElementById('examName').value;
            const schoolName = document.getElementById('schoolName').value;
            const examDate = document.getElementById('examDate').value;
            
            // 收集成绩信息
            const subjectNames = document.querySelectorAll('.subject-name');
            const subjectScores = document.querySelectorAll('.subject-score');
            const scores = [];
            
            for (let i = 0; i < subjectNames.length; i++) {
                const name = subjectNames[i].value;
                const score = subjectScores[i].value;
                
                if (name && score) {
                    scores.push({ name, score });
                }
            }
            
            // 验证信息
            if (!studentName || !studentId || !examName || !schoolName || !examDate || scores.length === 0) {
                confirmModal.classList.add('hidden');
                showMessage('请填写完整信息', 'warning');
                return;
            }
            
            // 保存成绩数据
            studentScores = {
                studentName,
                studentId,
                examName,
                schoolName,
                examDate,
                scores
            };
            
            // 标记成绩已提交
            isTeacherScoreSubmitted = true;
            
            // 关闭确认弹窗
            confirmModal.classList.add('hidden');
            
            // 显示成功提示
            showMessage('成绩提交成功', 'success');
            
            // 返回到登录页面
            setTimeout(function() {
                showPage(loginPage);
                // 切换到学生登录
                document.getElementById('studentLoginBtn').click();
                // 重置表单
                document.getElementById('studentInfoForm').reset();
                const subjectsContainer = document.getElementById('subjectsContainer');
                // 保留一个科目行
                const subjectRows = subjectsContainer.querySelectorAll('.subject-row');
                for (let i = 1; i < subjectRows.length; i++) {
                    subjectRows[i].remove();
                }
                // 重置第一个科目行
                const firstRow = subjectRows[0];
                firstRow.querySelector('.subject-name').value = '';
                firstRow.querySelector('.subject-score').value = '';
                const deleteBtn = firstRow.querySelector('.delete-subject-btn');
                deleteBtn.setAttribute('disabled', 'disabled');
                deleteBtn.classList.remove('text-danger');
                deleteBtn.classList.add('text-gray-400');
            }, 1500);
        });
        
        // 取消提交
        document.getElementById('cancelConfirmBtn').addEventListener('click', function() {
            confirmModal.classList.add('hidden');
        });
        
        // 查询成绩
        document.getElementById('queryScoreBtn').addEventListener('click', function() {
            if (!studentScores) {
                showMessage('暂无成绩信息', 'info');
                return;
            }
            
            // 显示成绩区域
            document.getElementById('scoreDisplayArea').classList.remove('hidden');
            
            // 填充考试信息
            document.getElementById('examDisplay').textContent = studentScores.examName;
            document.getElementById('dateDisplay').textContent = studentScores.examDate;
            
            // 填充成绩表格
            const tableBody = document.getElementById('scoresTableBody');
            tableBody.innerHTML = '';
            
            studentScores.scores.forEach(score => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                // 根据分数设置颜色
                let scoreClass = '';
                const numScore = parseFloat(score.score);
                if (numScore >= 90) scoreClass = 'text-secondary font-medium';
                else if (numScore >= 80) scoreClass = 'text-primary font-medium';
                else if (numScore >= 70) scoreClass = 'text-warning font-medium';
                else scoreClass = 'text-danger font-medium';
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${score.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${scoreClass} text-right">${score.score}</td>
                `;
                
                tableBody.appendChild(row);
            });
        });
        
        // 退出登录
        document.getElementById('teacherLogoutBtn').addEventListener('click', function() {
            showPage(loginPage);
            document.getElementById('loginForm').reset();
        });
        
        document.getElementById('studentLogoutBtn').addEventListener('click', function() {
            showPage(loginPage);
            document.getElementById('loginForm').reset();
        });
        
        // 显示消息提示（从右侧滑入）
        function showMessage(content, type = 'info') {
            const messageToast = document.getElementById('messageToast');
            const messageContent = document.getElementById('messageContent');
            const messageIcon = document.getElementById('messageIcon');
            const messageTitle = document.getElementById('messageTitle');
            
            messageContent.textContent = content;
            
            // 重置位置
            messageToast.style.transition = 'none';
            messageToast.style.transform = 'translateX(100%)';
            
            // 根据类型设置图标、标题和背景颜色
            switch (type) {
                case 'success':
                    messageIcon.className = 'fa fa-check-circle text-xl text-white mr-3';
                    messageTitle.textContent = '成功';
                    messageToast.className = 'fixed top-4 right-0 transform translate-x-full z-50 flex items-center p-4 rounded-lg shadow-xl transition-all duration-300 ease-out max-w-sm bg-green-500';
                    break;
                case 'error':
                    messageIcon.className = 'fa fa-times-circle text-xl text-white mr-3';
                    messageTitle.textContent = '错误';
                    messageToast.className = 'fixed top-4 right-0 transform translate-x-full z-50 flex items-center p-4 rounded-lg shadow-xl transition-all duration-300 ease-out max-w-sm bg-red-500';
                    break;
                case 'warning':
                    messageIcon.className = 'fa fa-exclamation-triangle text-xl text-white mr-3';
                    messageTitle.textContent = '警告';
                    messageToast.className = 'fixed top-4 right-0 transform translate-x-full z-50 flex items-center p-4 rounded-lg shadow-xl transition-all duration-300 ease-out max-w-sm bg-yellow-500';
                    break;
                default:
                    messageIcon.className = 'fa fa-info-circle text-xl text-white mr-3';
                    messageTitle.textContent = '提示';
                    messageToast.className = 'fixed top-4 right-0 transform translate-x-full z-50 flex items-center p-4 rounded-lg shadow-xl transition-all duration-300 ease-out max-w-sm bg-primary';
            }
            
            // 强制重绘
            void messageToast.offsetWidth;
            
            // 恢复过渡并显示
            messageToast.style.transition = 'all 300ms ease-out';
            messageToast.style.transform = 'translateX(0)';
            
            // 3秒后自动关闭
            setTimeout(() => {
                messageToast.style.transition = 'all 300ms ease-in-out';
                messageToast.style.transform = 'translateX(100%)';
            }, 3000);
        }
        
        // 会员功能展示
        document.querySelector('.bg-white\\/20').addEventListener('click', function() {
            const memberFeatures = document.getElementById('memberFeatures');
            memberFeatures.classList.toggle('hidden');
        });
        
        // 开通会员浮动按钮点击事件
        document.getElementById('openMemberBtn').addEventListener('click', function() {
            document.getElementById('memberPurchaseModal').classList.remove('hidden');
        });
        
        // 取消购买会员
        document.getElementById('cancelPaymentBtn').addEventListener('click', function() {
            document.getElementById('memberPurchaseModal').classList.add('hidden');
        });
        
        // 会员选项切换
        const memberOptions = document.querySelectorAll('.member-option');
        memberOptions.forEach(option => {
            option.addEventListener('click', function() {
                // 移除其他选项的选中状态
                memberOptions.forEach(opt => {
                    opt.classList.remove('border-primary', 'bg-primary/5', 'active');
                    opt.classList.add('border-gray-200');
                });
                
                // 设置当前选项为选中状态
                this.classList.remove('border-gray-200');
                this.classList.add('border-primary', 'bg-primary/5', 'active');
                
                // 更新支付按钮的价格
                const price = this.getAttribute('data-price');
                document.getElementById('confirmPaymentBtn').textContent = `立即支付 ¥${price}`;
            });
        });
        
        // 支付方式切换
        const paymentOptions = document.querySelectorAll('.payment-option');
        paymentOptions.forEach(option => {
            option.addEventListener('click', function() {
                // 移除其他支付方式的选中状态
                paymentOptions.forEach(opt => {
                    opt.classList.remove('active');
                    const checkIcon = opt.querySelector('i:last-child');
                    checkIcon.className = 'fa fa-circle text-gray-300';
                });
                
                // 设置当前支付方式为选中状态
                this.classList.add('active');
                const checkIcon = this.querySelector('i:last-child');
                checkIcon.className = 'fa fa-check-circle text-primary';
            });
        });
        
        // 立即支付按钮点击事件
        document.getElementById('confirmPaymentBtn').addEventListener('click', function() {
            // 显示网络异常提示
            showMessage('啊哦，网络出现异常，请稍后再试', 'error');
        });
        
        // 点击消息提示可手动关闭
        document.getElementById('messageToast').addEventListener('click', function() {
            this.style.transition = 'all 300ms ease-in-out';
            this.style.transform = 'translateX(100%)';
        });
        
        // 初始化日期为今天
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const formattedDate = `${year}-${month}-${day}`;
            
            document.getElementById('examDate').value = formattedDate;
        });
    </script>
</body>
</html>